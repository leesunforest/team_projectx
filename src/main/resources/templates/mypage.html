<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>save</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            margin: 0;
        }

        div.container {
            text-align: center;
            margin-top: 60px;
        }

        div.container .buttons {
            margin-top: 10px;
            text-align: center;
        }

        div.container .buttons button {
            width: 120px;
            height: 50px;
            padding: 10px 20px;
            background-color: #999999;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            margin: 0 30px;
        }

        div.container .buttons button:hover {
            background-color: #666666;
        }

        div#userReqList {
            margin-top: 20px;
        }

        div#userReqList ul {
            list-style-type: none;
            padding: 0;
        }

        div#userReqList ul li {
            padding: 10px;
            border: 1px solid #ddd;
            margin-bottom: 5px;
            cursor: pointer;
        }

        div#userReqList ul li:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
<div class="container">
    <h2 th:if="${session.userId}" th:text="${session.userId} + '님'"></h2>
    <a th:if="${session.userId}" href="/logout">로그아웃</a>
    <div class="buttons">
        <button onclick="userStoreReq()">저장한 가게</button>
        <button onclick="userBoardReq()">내가 쓴 글</button>
        <button onclick="userCommentReq()">내가 쓴 댓글</button>
    </div>
    <hr>
    <div id="userReqList">
    </div>
</div>
<script>
    const userStoreReq = () => {
        fetch('/mypage/favorite')
            .then(response => response.json())
            .then(data => {
                const userReqListDiv = document.getElementById('userReqList');
                userReqListDiv.innerHTML = '';

                if (data.length > 0) {
                    const ul = document.createElement('ul');

                    data.forEach(item => {

                        //이 부분 수정

                    });

                    userReqListDiv.appendChild(ul);
                } else {
                    userReqListDiv.textContent = '저장한 가게가 없습니다.';
                }
            })
            .catch(error => {
                console.error('Error fetching user boards:', error);
                document.getElementById('userReqList').textContent = '가게 정보를 불러오는 중 오류가 발생했습니다.';
            });
    };

    const userBoardReq = () => {
        fetch('/board/userBoard')
            .then(response => response.json())
            .then(data => {
                const userReqListDiv = document.getElementById('userReqList');
                userReqListDiv.innerHTML = '';

                if (data.length > 0) {
                    const ul = document.createElement('ul');

                    data.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = `제목: ${item.boardTitle}, 조회수: ${item.boardHits}`;
                        li.onclick = () => {
                            window.location.href = `/board/${item.id}`;
                        };
                        ul.appendChild(li);
                    });

                    userReqListDiv.appendChild(ul);
                } else {
                    userReqListDiv.textContent = '작성한 게시글이 없습니다.';
                }
            })
            .catch(error => {
                console.error('Error fetching user boards:', error);
                document.getElementById('userReqList').textContent = '게시글을 불러오는 중 오류가 발생했습니다.';
            });
    };

    const userCommentReq = () => {
        fetch('/comment/userComment')
            .then(response => response.json())
            .then(data => {
                const userReqListDiv = document.getElementById('userReqList');
                userReqListDiv.innerHTML = '';

                if (data.length > 0) {
                    const ul = document.createElement('ul');

                    data.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = ` ${item.commentContents}, 작성일자: ${item.commentCreatedTime}`;
                        li.onclick = () => {
                            window.location.href = `/board/${item.boardId}`;
                        };
                        ul.appendChild(li);
                    });

                    userReqListDiv.appendChild(ul);
                } else {
                    userReqListDiv.textContent = '작성한 댓글이 없습니다.';
                }
            })
            .catch(error => {
                console.error('Error fetching user boards:', error);
                document.getElementById('userReqList').textContent = '댓글을 불러오는 중 오류가 발생했습니다.';
            });
    };

</script>
</body>
</html>
